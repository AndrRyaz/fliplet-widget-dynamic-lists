<script type="text/javascript">
  var DynamicListFuncs = {};
  var dynamicLists = {};
</script>
{{#if layout}}
  {{#if advancedSettings.cssEnabled}}
  <style>
  {{{advancedSettings.cssCode}}}
  </style>
  {{/if}}
  <div data-dynamic-lists-1-2-0-id="{{ id }}" data-dynamic-lists-layout="{{ layout }}" data-dynamic-lists-uuid="{{uuid}}"></div>
  {{#if advancedSettings.jsEnabled}}
  <script type="text/javascript">
    Fliplet().then(function () {
      try {
        {{{ advancedSettings.jsCode }}}
      } catch (e) {
        console.log('Error with custom JS code', e);
      }

      var dynamicLists = new Fliplet.Registry.get('dynamic-lists:1.2.0');
      // This function will run for each instance found in the page
      Fliplet.Widget.instance('dynamic-lists-1-2-0', function (data) {
        // The HTML element for each instance. You can use $(element) to use jQuery functions on it
        var container = this;

        var dynamicList = new dynamicLists(container, data);
        dynamicList.start();
      });
    });
  </script>
  {{else}}
    <script type="text/javascript">
      var assetUrl = {
        'small-card': '{{{ asset "js/layout-javascript/small-card-code.js" }}}',
        'news-feed': '{{{ asset "js/layout-javascript/news-feed-code.js" }}}',
        'agenda': '{{{ asset "js/layout-javascript/agenda-code.js" }}}',
        'small-h-card': '{{{ asset "js/layout-javascript/small-h-card-code.js" }}}',
        'simple-list': '{{{ asset "js/layout-javascript/simple-list-code.js" }}}'
      };
    </script>
    <div data-script-insert="{{ id }}" class="hidden"></div>
    <script type="text/javascript">
      var script = document.createElement('script');
      script.onload = function() {
        Fliplet().then(function () {
          var dynamicLists = new Fliplet.Registry.get('dynamic-lists:1.2.0');

          // This function will run for each instance found in the page
          Fliplet.Widget.instance('dynamic-lists-1-2-0', function (data) {
            // The HTML element for each instance. You can use $(element) to use jQuery functions on it
            var container = this;

            var dynamicList = new dynamicLists(container, data);
            dynamicList.start();
          });
        });
      };
      script.src = assetUrl['{{ layout }}'];
      document.querySelector('[data-script-insert="{{ id }}"]').appendChild(script);
    </script>
  {{/if}}
{{else}}
<div class="dynamic-list-placeholder">
  <h3>List (from data source)</h3>
  <p>Click here to edit the settings.</p>
</div>
{{/if}}